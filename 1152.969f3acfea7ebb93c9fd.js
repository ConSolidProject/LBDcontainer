"use strict";(self.webpackChunklbdserver=self.webpackChunklbdserver||[]).push([[1152],{91152:(e,t,n)=>{n.r(t);var r=n(77865),o=n.n(r),c=n(21704),a=n.n(c),l=n(29439),i=n(15861),s=n(87757),u=n.n(s),m=n(90471),d=n.n(m);n(334);var p=d()(function(){var e=(0,i.Z)(u().mark((function e(t,n){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("scope, module",t,n),e.next=3,window[t].get(n);case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),f=d()((function(e){return new Promise((function(t,n){try{e.url||(console.log("no url provided"),n());var r=document.createElement("script");r.src=e.url,r.type="text/javascript",r.async=!0,document.head.appendChild(r),r.onload=function(){console.log("Dynamic Script Loaded: ".concat(e.url)),t()},r.onerror=function(){console.error("Dynamic Script Error: ".concat(e.url)),n()}}catch(e){console.log("error",e),n(e)}}))}));d()(function(){var e=(0,i.Z)(u().mark((function e(t,n){var r,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.system,e.prev=1,e.next=4,f(r);case 4:return e.next=6,p(r.scope,r.module);case 6:return o=e.sent,e.abrupt("return",o()[n]);case 10:e.prev=10,e.t0=e.catch(1),console.log("error in getFromRemote",e.t0);case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t,n){return e.apply(this,arguments)}}());var y=n(46078);n(99170);var v=n(75073),h=(n(72231).v4,n(99170)),g=(0,y.atom)({key:"store",default:new h.Store}),E=(0,y.atom)({key:"openOptions",default:!0}),b=((0,y.atom)({key:"session",default:new v.Session}),(0,y.atom)({key:"projects",default:[]})),w=(0,y.atom)({key:"activeResources",default:[]}),x=(0,y.atom)({key:"selectedElements",default:[]}),j=(0,y.atom)({key:"selectionId",default:""}),O=(0,y.atom)({key:"trigger",default:1});const Z=(0,y.atom)({key:"config",default:{tabs:{url:"https://consolidproject.github.io/pluginAggregatorTabs/remoteEntry.js",scope:"tabs",label:"tabs",module:"./index",dimensions:{x:0,y:0,h:900,w:600},children:{resourcemanager:{url:"https://consolidproject.github.io/pluginResourceManager/remoteEntry.js",scope:"resourcemanager",module:"./index",icon:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"},projectquery:{url:"http://localhost:8083/remoteEntry.js",scope:"projectquery",module:"./index",icon:"M7 9H2V7h5v2zm0 3H2v2h5v-2zm13.59 7-3.83-3.83c-.8.52-1.74.83-2.76.83-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5c0 1.02-.31 1.96-.83 2.75L22 17.59 20.59 19zM17 11c0-1.65-1.35-3-3-3s-3 1.35-3 3 1.35 3 3 3 3-1.35 3-3zM2 19h10v-2H2v2z"}}},viewer:{url:"http://localhost:8082/remoteEntry.js",scope:"viewer",module:"./index",dimensions:{x:600,y:0,h:450,w:660}},imageannotator:{url:"http://localhost:8084/remoteEntry.js",scope:"imageannotator",module:"./index",dimensions:{x:600,y:450,h:450,w:660}}}});var k=n(74283),S=n(71342),R=n(4942),P=n(13090),z=n.n(P);function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){(0,R.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var L=d()(function(){var e=(0,i.Z)(u().mark((function e(t,n){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window[t].get(n);case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),H=d()((function(e){return new Promise((function(t,n){try{e.url||(console.log("no url provided"),n());var r=document.createElement("script");r.src=e.url,r.type="text/javascript",r.async=!0,document.head.appendChild(r),r.onload=function(){t()},r.onerror=function(){n()}}catch(e){console.log("error",e),n(e)}}))})),I=d()(function(){var e=(0,i.Z)(u().mark((function e(t,n){var r,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.system,e.prev=1,e.next=4,H(r);case 4:return e.next=6,L(r.scope,r.module);case 6:return o=e.sent,e.abrupt("return",o()[n]);case 10:e.prev=10,e.t0=e.catch(1),console.log("error in getFromRemote",e.t0);case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t,n){return e.apply(this,arguments)}}());const T=o().memo((function(e){var t=(0,r.useRef)(null),n=(0,r.useState)(null),c=(0,l.Z)(n,2),a=c[0],s=c[1];(0,r.useEffect)((function(){m(e)}));var m=function(){var n=(0,i.Z)(u().mark((function n(){return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,I(e,"default");case 3:(0,n.sent)(t.current,C({},e)),n.next=11;break;case 7:throw n.prev=7,n.t0=n.catch(0),s(n.t0.message),n.t0;case 11:case"end":return n.stop()}}),n,null,[[0,7]])})));return function(){return n.apply(this,arguments)}}();return o().createElement("div",null,a?o().createElement("div",null,o().createElement("h3",null,"Error loading remote component"),o().createElement("p",null,a),o().createElement("p",null,"Check console for more information")):o().createElement("div",{ref:t},"Loading"))}));var M=n(86712),V=n(15832),B=n(44080),F=n(77315),q=n(35025),G=n(64566);n(15671),n(43144),n(60136),n(82963),n(61120);function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function W(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(Object(n),!0).forEach((function(t){(0,R.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function A(e){var t=(0,y.useRecoilValue)(Z),n=(0,r.useState)(Object.keys(t)),c=(0,l.Z)(n,2),a=c[0],i=c[1];return(0,r.useEffect)((function(){console.log("modules",t),i(Object.keys(t))}),[t]),o().createElement("div",{style:{marginTop:64,marginLeft:-10}},a.map((function(e){if(t[e]&&t[e].dimensions)return o().createElement(U,{key:e,id:e,mod:t[e]})})))}o().Component;var Q=d()((function(e){return(0,y.atom)({key:"boxState_".concat(e.url),default:{x:e.dimensions.x,y:e.dimensions.y,w:e.dimensions.w,h:e.dimensions.h,fixed:!0}})})),U=function(e){var t=e.id,n=e.mod,c=(0,y.useRecoilState)(Q(n)),a=(0,l.Z)(c,2),i=a[0],s=a[1],u=(0,r.useState)(!1),m=(0,l.Z)(u,2),d=(m[0],m[1],(0,r.useRef)());return o().createElement(z(),{nodeRef:d,position:{x:i.x,y:i.y},onDrag:function(e,t){s(W(W({},i),{},{x:t.x,y:t.y}))},disabled:i.fixed},o().createElement("div",{id:"module".concat(t),ref:d,className:"box",style:{width:i.w,height:i.h,display:"flex",position:"absolute",background:"white",border:"1px LightGray solid"}},n.dimensions.fixed?o().createElement(o().Fragment,null):o().createElement("div",null,o().createElement(M.IconButton,{color:"primary",style:{position:"absolute",right:0,bottom:0,zIndex:1},onClick:function(){s(W(W({},i),{},{x:n.dimensions.x,y:n.dimensions.y,fixed:!0,minimized:!1}))}},o().createElement(V.Z,null)),o().createElement(M.IconButton,{color:"primary",style:{position:"absolute",right:80,bottom:0,zIndex:1},onClick:function(){i.minimized?s(W(W({},i),{},{minimized:!1,w:n.w,h:n.h})):s(W(W({},i),{},{minimized:!0,w:300,h:50,y:Math.max(i.y,0)}))}},i.minimized?o().createElement(G.default,null):o().createElement(q.Z,null)),o().createElement(M.IconButton,{color:"primary",style:{position:"absolute",right:40,bottom:0,zIndex:1},onClick:function(){return s(W(W({},i),{},{fixed:!i.fixed}))}},i.fixed?o().createElement(B.Z,null):o().createElement(F.Z,null))),i.minimized?o().createElement(M.Typography,{style:{marginLeft:10,marginTop:15}},t.toUpperCase()):o().createElement("div",null,o().createElement(r.Suspense,{fallback:o().createElement("p",null,"loading ...")},o().createElement(_,{mod:n})))))},_=function(e){var t=e.mod,n=(0,y.useRecoilValue)(g),c=(0,y.useRecoilValue)(Z),a=(0,y.useRecoilState)(w),i=(0,l.Z)(a,2),s=i[0],u=i[1],m=(0,y.useRecoilState)(x),d=(0,l.Z)(m,2),p=d[0],f=d[1],h=(0,y.useRecoilState)(b),E=(0,l.Z)(h,2),k=E[0],S=E[1],R=(0,y.useRecoilState)(j),P=(0,l.Z)(R,2),z=P[0],D=P[1],C=(0,y.useRecoilState)(O),L=(0,l.Z)(C,2),H=L[0],I=L[1],M=(0,r.useState)(1),V=(0,l.Z)(M,2),B=V[0],F=V[1];(0,r.useEffect)((function(){F((function(e){return e+1}))}),[c]);var q={trigger:H,setTrigger:I,projects:k,setProjects:S,store:n,activeResources:s,setActiveResources:u,selectedElements:p,setSelectedElements:f,selectionId:z,setSelectionId:D,session:(0,v.getDefaultSession)()};return o().createElement(T,{key:B,system:{module:t.module,url:t.url,scope:t.scope},sharedProps:q,module:t,config:c})},J=n(99170).DataFactory;J.namedNode,J.literal,J.defaultGraph,J.quad;const K=function(e){return e.sharedProps,o().createElement("div",null,o().createElement(A,null))};var X=n(45258),Y=n(28358),$=n(22318),ee=n(17812),te=n(60424);function ne(){var e=(0,y.useRecoilState)(E),t=(0,l.Z)(e,2),n=t[0],r=t[1];return o().createElement(o().Fragment,null,o().createElement(X.Z,null,o().createElement(Y.Z,null,o().createElement($.Z,{variant:"h6",color:"inherit",noWrap:!0,to:"/",style:{color:"white",textDecoration:"none"}},"LBDserver"),o().createElement("div",{style:{flexGrow:1}}),o().createElement(ee.Z,{variant:"outlined",color:"primary",key:"setup",style:{color:"white",fontWeight:"normal"},onClick:function(){return r(!n)}},o().createElement(te.Z,null)))))}var re=n(55961),oe=n(5034),ce=n(26975),ae=(n(72231),(0,oe.Z)({productionPrefix:"main",seed:"main"})),le=n(99170).DataFactory;le.namedNode,le.literal,le.defaultGraph,le.quad,(0,re.createBrowserHistory)();const ie=function(){var e=(0,y.useRecoilValue)(g),t=(0,y.useRecoilState)(w),n=(0,l.Z)(t,2),c=(n[0],n[1],(0,y.useRecoilState)(x)),a=(0,l.Z)(c,2),i=(a[0],a[1],(0,y.useRecoilState)(b)),s=(0,l.Z)(i,2),u=s[0],m=s[1],d=(0,y.useRecoilState)(j),p=(0,l.Z)(d,2),f=(p[0],p[1],(0,y.useRecoilState)(O)),h=(0,l.Z)(f,2),R=h[0],P=h[1],z=(0,y.useRecoilState)(E),D=(0,l.Z)(z,2),C=D[0],L=D[1],H=(0,y.useRecoilState)(Z),I=(0,l.Z)(H,2),T=I[0],V=I[1];return(0,r.useEffect)((function(){console.log("config changed")}),[T]),(0,r.useEffect)((function(){u.length>0&&(0,k.loadProjectMetadata)(u[0],e,(0,v.getDefaultSession)()).then((function(){return console.log("loaded")}))}),[]),o().createElement(ce.ZP,{generateClassName:ae},o().createElement(ne,{name:"LBDserver"}),u.length>0?o().createElement(K,null):o().createElement("div",{style:{marginTop:100,justifyContent:"center"}},o().createElement(M.Typography,{variant:"h5"},"Please select a project via the sidebar")),o().createElement(S.Options,{openOptions:C,setOpenOptions:L,trigger:R,setTrigger:P,projects:u,setProjects:m,store:e,config:T,setConfig:V,drawerWidth:"40%"}))};var se=n(19705);a().render(o().createElement(se.QueryClientProvider,{client:new se.QueryClient},o().createElement(y.RecoilRoot,null,o().createElement(ie,null))),document.querySelector("#root"))}}]);