"use strict";(self.webpackChunklbdserver=self.webpackChunklbdserver||[]).push([[1152],{91152:(e,t,r)=>{r.r(t);var n=r(77865),o=r.n(n),c=r(21704),a=r.n(c),i=r(29439),l=r(15861),s=r(87757),u=r.n(s),m=r(90471),p=r.n(m);r(334);var d=p()(function(){var e=(0,l.Z)(u().mark((function e(t,r){var n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("scope, module",t,r),e.next=3,window[t].get(r);case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()),f=p()((function(e){return new Promise((function(t,r){try{e.url||(console.log("no url provided"),r());var n=document.createElement("script");n.src=e.url,n.type="text/javascript",n.async=!0,document.head.appendChild(n),n.onload=function(){console.log("Dynamic Script Loaded: ".concat(e.url)),t()},n.onerror=function(){console.error("Dynamic Script Error: ".concat(e.url)),r()}}catch(e){console.log("error",e),r(e)}}))}));p()(function(){var e=(0,l.Z)(u().mark((function e(t,r){var n,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.system,e.prev=1,e.next=4,f(n);case 4:return e.next=6,d(n.scope,n.module);case 6:return o=e.sent,e.abrupt("return",o()[r]);case 10:e.prev=10,e.t0=e.catch(1),console.log("error in getFromRemote",e.t0);case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t,r){return e.apply(this,arguments)}}());var y=r(46078);r(99170);var v=r(75073),g=(r(72231).v4,r(99170)),h=(0,y.atom)({key:"store",default:new g.Store}),E=(0,y.atom)({key:"openOptions",default:!0}),b=((0,y.atom)({key:"session",default:new v.Session}),(0,y.atom)({key:"projects",default:[]})),w=(0,y.atom)({key:"activeResources",default:[]}),x=(0,y.atom)({key:"selectedElements",default:[]}),j=(0,y.atom)({key:"selectionId",default:""}),O=(0,y.atom)({key:"trigger",default:1});const Z=(0,y.atom)({key:"config",default:{tabs:{url:"https://consolidproject.github.io/pluginAggregatorTabs/remoteEntry.js",scope:"tabs",label:"tabs",module:"./index",dimensions:{x:0,y:0,h:850,w:600},children:{resourcemanager:{url:"https://consolidproject.github.io/pluginResourceManager/remoteEntry.js",scope:"resourcemanager",module:"./index",icon:"M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"},projectquery:{url:"https://consolidproject.github.io/pluginQuery/remoteEntry.js",scope:"projectquery",module:"./index",icon:"M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"}}},viewer:{url:"https://consolidproject.github.io/pluginViewer/remoteEntry.js",scope:"viewer",module:"./index",dimensions:{x:600,y:0,h:450,w:660}}}});var k=r(74283),S=r(64414),R=r(4942),P=r(13090),D=r.n(P);function C(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function z(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?C(Object(r),!0).forEach((function(t){(0,R.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var I=p()(function(){var e=(0,l.Z)(u().mark((function e(t,r){var n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window[t].get(r);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()),L=p()((function(e){return new Promise((function(t,r){try{e.url||(console.log("no url provided"),r());var n=document.createElement("script");n.src=e.url,n.type="text/javascript",n.async=!0,document.head.appendChild(n),n.onload=function(){t()},n.onerror=function(){r()}}catch(e){console.log("error",e),r(e)}}))})),T=p()(function(){var e=(0,l.Z)(u().mark((function e(t,r){var n,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.system,e.prev=1,e.next=4,L(n);case 4:return e.next=6,I(n.scope,n.module);case 6:return o=e.sent,e.abrupt("return",o()[r]);case 10:e.prev=10,e.t0=e.catch(1),console.log("error in getFromRemote",e.t0);case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t,r){return e.apply(this,arguments)}}());const B=o().memo((function(e){var t=(0,n.useRef)(null),r=(0,n.useState)(null),c=(0,i.Z)(r,2),a=c[0],s=c[1];(0,n.useEffect)((function(){m(e)}));var m=function(){var r=(0,l.Z)(u().mark((function r(){return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,T(e,"default");case 3:(0,r.sent)(t.current,z({},e)),r.next=11;break;case 7:throw r.prev=7,r.t0=r.catch(0),s(r.t0.message),r.t0;case 11:case"end":return r.stop()}}),r,null,[[0,7]])})));return function(){return r.apply(this,arguments)}}();return o().createElement("div",null,a?o().createElement("div",null,o().createElement("h3",null,"Error loading remote component"),o().createElement("p",null,a),o().createElement("p",null,"Check console for more information")):o().createElement("div",{ref:t},"Loading"))}));var F=r(86712),q=r(15832),M=r(44080),V=r(77315),G=r(35025),N=r(64566);r(15671),r(43144),r(60136),r(82963),r(61120);function Q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function W(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(r),!0).forEach((function(t){(0,R.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Q(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function A(e){var t=(0,y.useRecoilValue)(Z),r=(0,n.useState)(Object.keys(t)),c=(0,i.Z)(r,2),a=c[0],l=c[1];return(0,n.useEffect)((function(){console.log("modules",t),l(Object.keys(t))}),[t]),o().createElement("div",{style:{marginTop:64,marginLeft:-10}},a.map((function(e){if(t[e]&&t[e].dimensions)return o().createElement(U,{key:e,id:e,mod:t[e]})})))}o().Component;var H=p()((function(e){return(0,y.atom)({key:"boxState_".concat(e.url),default:{x:e.dimensions.x,y:e.dimensions.y,w:e.dimensions.w,h:e.dimensions.h,fixed:!0}})})),U=function(e){var t=e.id,r=e.mod,c=(0,y.useRecoilState)(H(r)),a=(0,i.Z)(c,2),l=a[0],s=a[1],u=(0,n.useState)(!1),m=(0,i.Z)(u,2),p=(m[0],m[1],(0,n.useRef)());return o().createElement(D(),{nodeRef:p,position:{x:l.x,y:l.y},onDrag:function(e,t){s(W(W({},l),{},{x:t.x,y:t.y}))},disabled:l.fixed},o().createElement("div",{id:"module".concat(t),ref:p,className:"box",style:{width:l.w,height:l.h,display:"flex",position:"absolute",background:"white",border:"1px LightGray solid"}},r.dimensions.fixed?o().createElement(o().Fragment,null):o().createElement("div",null,o().createElement(F.IconButton,{color:"primary",style:{position:"absolute",right:0,bottom:0,zIndex:1},onClick:function(){s(W(W({},l),{},{x:r.dimensions.x,y:r.dimensions.y,fixed:!0,minimized:!1}))}},o().createElement(q.Z,null)),o().createElement(F.IconButton,{color:"primary",style:{position:"absolute",right:80,bottom:0,zIndex:1},onClick:function(){l.minimized?s(W(W({},l),{},{minimized:!1,w:r.w,h:r.h})):s(W(W({},l),{},{minimized:!0,w:300,h:50,y:Math.max(l.y,0)}))}},l.minimized?o().createElement(N.default,null):o().createElement(G.Z,null)),o().createElement(F.IconButton,{color:"primary",style:{position:"absolute",right:40,bottom:0,zIndex:1},onClick:function(){return s(W(W({},l),{},{fixed:!l.fixed}))}},l.fixed?o().createElement(M.Z,null):o().createElement(V.Z,null))),l.minimized?o().createElement(F.Typography,{style:{marginLeft:10,marginTop:15}},t.toUpperCase()):o().createElement("div",null,o().createElement(n.Suspense,{fallback:o().createElement("p",null,"loading ...")},o().createElement(_,{mod:r})))))},_=function(e){var t=e.mod,r=(0,y.useRecoilValue)(h),c=(0,y.useRecoilValue)(Z),a=(0,y.useRecoilState)(w),l=(0,i.Z)(a,2),s=l[0],u=l[1],m=(0,y.useRecoilState)(x),p=(0,i.Z)(m,2),d=p[0],f=p[1],g=(0,y.useRecoilState)(b),E=(0,i.Z)(g,2),k=E[0],S=E[1],R=(0,y.useRecoilState)(j),P=(0,i.Z)(R,2),D=P[0],C=P[1],z=(0,y.useRecoilState)(O),I=(0,i.Z)(z,2),L=I[0],T=I[1],F=(0,n.useState)(1),q=(0,i.Z)(F,2),M=q[0],V=q[1];(0,n.useEffect)((function(){V((function(e){return e+1}))}),[c]);var G={trigger:L,setTrigger:T,projects:k,setProjects:S,store:r,activeResources:s,setActiveResources:u,selectedElements:d,setSelectedElements:f,selectionId:D,setSelectionId:C,session:(0,v.getDefaultSession)()};return o().createElement(B,{key:M,system:{module:t.module,url:t.url,scope:t.scope},sharedProps:G,module:t,config:c})},J=r(99170).DataFactory;J.namedNode,J.literal,J.defaultGraph,J.quad;const K=function(e){return e.sharedProps,o().createElement("div",null,o().createElement(A,null))};var X=r(45258),Y=r(28358),$=r(22318),ee=r(17812),te=r(60424);function re(){var e=(0,y.useRecoilState)(E),t=(0,i.Z)(e,2),r=t[0],n=t[1];return o().createElement(o().Fragment,null,o().createElement(X.Z,null,o().createElement(Y.Z,null,o().createElement($.Z,{variant:"h6",color:"inherit",noWrap:!0,to:"/",style:{color:"white",textDecoration:"none"}},"LBDserver"),o().createElement("div",{style:{flexGrow:1}}),o().createElement(ee.Z,{variant:"outlined",color:"primary",key:"setup",style:{color:"white",fontWeight:"normal"},onClick:function(){return n(!r)}},o().createElement(te.Z,null)))))}var ne=r(55961),oe=r(5034),ce=r(26975),ae=(r(72231),(0,oe.Z)({productionPrefix:"main",seed:"main"})),ie=r(99170).DataFactory;ie.namedNode,ie.literal,ie.defaultGraph,ie.quad,(0,ne.createBrowserHistory)();const le=function(){var e=(0,y.useRecoilValue)(h),t=(0,y.useRecoilState)(w),r=(0,i.Z)(t,2),c=(r[0],r[1],(0,y.useRecoilState)(x)),a=(0,i.Z)(c,2),l=(a[0],a[1],(0,y.useRecoilState)(b)),s=(0,i.Z)(l,2),u=s[0],m=s[1],p=(0,y.useRecoilState)(j),d=(0,i.Z)(p,2),f=(d[0],d[1],(0,y.useRecoilState)(O)),g=(0,i.Z)(f,2),R=g[0],P=g[1],D=(0,y.useRecoilState)(E),C=(0,i.Z)(D,2),z=C[0],I=C[1],L=(0,y.useRecoilState)(Z),T=(0,i.Z)(L,2),B=T[0],q=T[1];return(0,n.useEffect)((function(){console.log("config changed")}),[B]),(0,n.useEffect)((function(){u.length>0&&(0,k.loadProjectMetadata)(u[0],e,(0,v.getDefaultSession)()).then((function(){return console.log("loaded")}))}),[]),o().createElement(ce.ZP,{generateClassName:ae},o().createElement(re,{name:"LBDserver"}),u.length>0?o().createElement(K,null):o().createElement("div",{style:{marginTop:100,justifyContent:"center"}},o().createElement(F.Typography,{variant:"h5"},"Please select a project via the sidebar")),o().createElement(S.Options,{openOptions:z,setOpenOptions:I,trigger:R,setTrigger:P,projects:u,setProjects:m,store:e,config:B,setConfig:q,drawerWidth:"40%"}))};var se=r(19705);a().render(o().createElement(se.QueryClientProvider,{client:new se.QueryClient},o().createElement(y.RecoilRoot,null,o().createElement(le,null))),document.querySelector("#root"))}}]);